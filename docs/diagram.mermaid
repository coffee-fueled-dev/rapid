sequenceDiagram
    participant User as User
    participant Browser as Browser
    participant RapidServer as RapidServer
    participant MW as Middleware
    participant RapidClient as RapidClient
    participant MicroRouter as MicroRouter

    Note over User,MicroRouter: Initial Page Load (SSR)
    
    User->>Browser: Visit /dashboard
    Browser->>RapidServer: GET /dashboard
    RapidServer->>MW: Execute middleware (auth, rate limiting)
    MW->>RapidServer: Middleware passed
    RapidServer->>RapidServer: Generate HTML with React SSR
    RapidServer->>Browser: Return HTML + /client.js + /styles.css
    
    Note over User,MicroRouter: Client-Side Hydration
    
    Browser->>Browser: Load HTML
    Browser->>RapidServer: GET /client.js
    RapidServer->>Browser: Return client bundle
    Browser->>RapidClient: Initialize RapidClient
    RapidClient->>MicroRouter: Setup client-side routing
    RapidClient->>Browser: Hydrate React components
    
    Note over User,MicroRouter: Client-Side Navigation
    
    User->>Browser: Click link to /dashboard/users
    Browser->>MicroRouter: Intercept navigation
    MicroRouter->>RapidServer: Fetch /dashboard/users (server-side)
    RapidServer->>MW: Execute middleware (auth, rate limiting)
    MW->>RapidServer: Middleware passed
    RapidServer->>MicroRouter: Return HTML response
    MicroRouter->>MicroRouter: Compare layout trees
    MicroRouter->>Browser: Preserve shared layouts
    MicroRouter->>Browser: Re-render only changed components
    Browser->>User: Updated page (no full reload)